
<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="canonical" href="https://sayheyshubh.netlify.app/microbiology" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-01VF0W2CD1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-01VF0W2CD1');
  </script>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BSc Microbiology Hons Notes PDF (DU) | Semester-wise Study Materials | SayHeyShubh</title>
  <meta name="description" content="Get the best BSc Microbiology Hons notes for Delhi University students. Verified semester-wise PDF notes, lab manuals, handwritten study material, and exam preparation resources for DU Microbiology." />
  <meta name="keywords" content="BSc Microbiology notes, DU Microbiology Hons, Delhi University Microbiology study material, Microbiology exam preparation, semester-wise notes, bacteriology notes, virology notes, immunology notes, BSc Microbiology practicals, Microbiology lab manuals, DU Microbiology Hons notes pdf, Microbiology Hons syllabus Delhi University, Microbiology Hons exam preparation notes, Microbiology Hons question bank, BSc Microbiology Hons previous year questions DU">
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="attached_assets/boom.png_1753383095125.png" sizes="32x32">
  <link rel="preload" href="attached_assets/boom.png_1753383095125.png" as="image">
  
  <!-- JSON-LD Schema Markup for FAQ -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [{
      "@type": "Question",
      "name": "Are these Microbiology notes suitable for DU exams?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. These Microbiology notes are strictly aligned with the Delhi University syllabus and prepared using standard textbooks and PYQs."
      }
    }]
  }
  </script>

  <!-- JSON-LD Schema for Educational Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "EducationalOrganization",
    "name": "SayHeyShubh",
    "url": "https://sayheyshubh.netlify.app",
    "description": "Student-first academic platform providing syllabus-aligned notes for DU students.",
    "sameAs": [
      "https://www.youtube.com/@ShubhiPhilia",
      "https://t.me/shubhiphilia"
    ],
    "keywords": "BSc Microbiology notes, DU Microbiology Hons, Delhi University Microbiology study material, Microbiology exam preparation, semester-wise notes, best Microbiology hons du notes, BSc Microbiology Hons semester wise notes, DU Microbiology Hons notes pdf, Microbiology Hons syllabus Delhi University, Microbiology Hons exam preparation notes, Microbiology Hons question bank, bsc Microbiology Hons previous year questions DU, Best notes for BSc Microbiology",
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "reviewCount": "150",
      "bestRating": "5"
    }
  }
  </script>

  <!-- JSON-LD Schema for Course -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Course",
    "name": "BSc Microbiology Honours - Complete Study Materials",
    "description": "Comprehensive BSc Microbiology Honours study materials for Delhi University students including semester-wise notes, previous year questions, and exam preparation resources.",
    "provider": {
      "@type": "EducationalOrganization",
      "name": "ShubhiPhilia",
      "url": "https://www.youtube.com/@ShubhiPhilia"
    },
    "educationalLevel": "Undergraduate",
    "coursePrerequisites": "12th Standard Science",
    "availableLanguage": "English",
    "inLanguage": "en",
    "isAccessibleForFree": true,
    "hasCourseInstance": {
      "@type": "CourseInstance",
      "courseMode": "online",
      "courseWorkload": "PT3Y"
    }
  }
  </script>

  <style>
    .youtube-container {
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .channel-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 3rem;
      text-align: center;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      padding: 3rem 2rem;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .channel-avatar {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      object-fit: cover;
      border: 5px solid #fff;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      transform: translateZ(0);
    }

    .channel-header .emoji-icon {
      width: 32px;
      height: 32px;
      border-radius: 0;
      border: none;
      box-shadow: none;
      display: inline-block;
      vertical-align: middle;
      margin: 0 5px;
    }

    .channel-name {
      font-size: 2.5rem;
      font-weight: 800;
      color: #1c1c1c;
      margin: 0;
    }

    .channel-description {
      max-width: 700px;
      margin: 0 auto;
      font-size: 1.1rem;
      color: #555;
      line-height: 1.7;
    }

    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
    }

    .youtube-btn, .notes-btn {
      padding: 1rem 2rem;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      border: none;
      cursor: pointer;
    }

    .youtube-btn {
      background: linear-gradient(45deg, #ff0000, #cc0000);
      color: white;
    }

    .youtube-btn:hover {
      background: linear-gradient(45deg, #cc0000, #990000);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3);
    }

    .notes-btn {
      background: linear-gradient(45deg, #00897b, #00695c);
      color: white;
    }

    .notes-btn:hover {
      background: linear-gradient(45deg, #00695c, #004d40);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 137, 123, 0.3);
    }

    .content-section {
      margin: 3rem 0;
    }

    .section-title {
      font-size: 2rem;
      font-weight: 700;
      color: #2d3748;
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 4px;
      background: linear-gradient(45deg, #6366f1, #4f46e5);
      border-radius: 2px;
    }

    .video-grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      margin-top: 2rem;
    }

    .video-item {
      background: #fff;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }

    .video-item:hover {
      transform: translateY(-5px);
    }

    .video-item iframe {
      width: 100%;
      height: 250px;
      border: none;
    }

    .video-info {
      padding: 1.5rem;
    }

    .video-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 0.5rem;
    }

    .stats-section {
      background: #f8fafc;
      padding: 2rem;
      border-radius: 15px;
      text-align: center;
      margin: 2rem 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .stat-item {
      background: #fff;
      padding: 1.5rem 1rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      cursor: pointer; 
      transition: all 0.3s ease; 
      }

    .stat-number {
      font-size: 1.8rem;
      font-weight: 800;
      color: #6366f1;
      display: block;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #718096;
      margin-top: 0.5rem;
    }

    .stat-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.2);
      background: #f8fafc;
    }

    /* FAQ Section Styles */
    .faq-section {
      background: #f8fafc;
      padding: 2rem;
      border-radius: 15px;
      margin: 3rem 0;
    }

    .faq-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .faq-item {
      background: white;
      border-radius: 12px;
      margin-bottom: 1rem;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
    }

    .faq-item:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .faq-question {
      width: 100%;
      padding: 1.5rem;
      background: white;
      border: none;
      text-align: left;
      font-size: 1.1rem;
      font-weight: 600;
      color: #2d3748;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .faq-question:hover {
      color: #6366f1;
    }

    .faq-icon {
      font-size: 1.5rem;
      color: #6366f1;
      font-weight: 300;
      transition: transform 0.3s ease;
    }

    .faq-question.active .faq-icon {
      transform: rotate(45deg);
    }

    .faq-answer {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
      background: #f8fafc;
    }

    .faq-answer.active {
      max-height: 9999px;
      padding: 1.5rem;
    }

    .faq-answer p {
      margin: 0;
      color: #4a5568;
      line-height: 1.7;
      font-size: 1rem;
    }

    /* Comments Section Styles - Compact & Modern */
    .comments-section {
      background: #ffffff;
      padding: 2rem 1.5rem;
      margin: 2rem 0;
    }

    .comment-form-container {
      max-width: 700px;
      margin: 0 auto 2rem;
      background: #f8fafc;
      padding: 1.2rem;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .comment-form-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 1rem;
      text-align: center;
    }

    .comment-form {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
      position: relative;
    }

    .form-group label {
      font-weight: 600;
      color: #4a5568;
      font-size: 0.85rem;
    }

    .form-group input,
    .form-group textarea {
      padding: 0.7rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 0.95rem;
      font-family: inherit;
      transition: all 0.3s ease;
      background: white;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .char-count {
      position: absolute;
      bottom: -1.3rem;
      right: 0;
      font-size: 0.75rem;
      color: #94a3b8;
    }

    .submit-comment-btn {
      padding: 0.7rem 1.5rem;
      background: linear-gradient(45deg, #6366f1, #4f46e5);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(99, 102, 241, 0.3);
      margin-top: 0.5rem;
    }

    .submit-comment-btn:hover {
      background: linear-gradient(45deg, #4f46e5, #4338ca);
      transform: translateY(-2px);
      box-shadow: 0 5px 14px rgba(99, 102, 241, 0.4);
    }

    .submit-comment-btn:disabled {
      background: #cbd5e1;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .auth-required-message {
      text-align: center;
      padding: 1.5rem;
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .auth-required-message button {
      margin-top: 0.8rem;
      padding: 0.6rem 1.5rem;
      background: #6366f1;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .auth-required-message button:hover {
      background: #4f46e5;
      transform: translateY(-2px);
    }

    .comments-display {
      max-width: 900px;
      margin: 0 auto;
    }

    .comments-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .comments-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .comment-item {
      background: white;
      padding: 1rem;
      border-radius: 10px;
      border-left: 3px solid #6366f1;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
      transition: all 0.3s ease;
    }

    .comment-item:hover {
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      transform: translateX(3px);
    }

    .comment-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.6rem;
      gap: 0.5rem;
    }

    .comment-author-info {
      flex: 1;
    }

    .comment-author {
      font-weight: 700;
      color: #2d3748;
      font-size: 0.95rem;
      display: block;
    }

    .comment-email {
      font-size: 0.75rem;
      color: #94a3b8;
      display: block;
      margin-top: 0.1rem;
    }

    .comment-date {
      font-size: 0.75rem;
      color: #94a3b8;
      white-space: nowrap;
    }

    .comment-text {
      color: #4a5568;
      line-height: 1.6;
      font-size: 0.95rem;
      margin: 0 0 0.6rem 0;
    }

    .comment-actions {
      display: flex;
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .reply-btn {
      background: none;
      border: none;
      color: #6366f1;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    .reply-btn:hover {
      background: #ede9fe;
    }

    .replies-container {
      margin-top: 0.8rem;
      padding-left: 1.5rem;
      border-left: 2px solid #e2e8f0;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .replies-container.show {
      max-height: 9999px;
    }

    .view-replies-btn {
      background: none;
      border: none;
      color: #6366f1;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      margin-top: 0.5rem;
    }

    .view-replies-btn:hover {
      background: #ede9fe;
    }

    .view-replies-btn .arrow {
      transition: transform 0.3s ease;
      display: inline-block;
    }

    .view-replies-btn.active .arrow {
      transform: rotate(180deg);
    }

    .reply-item {
      background: #f8fafc;
      padding: 0.8rem;
      border-radius: 8px;
      margin-bottom: 0.6rem;
      border-left: 2px solid #a5b4fc;
    }

    .reply-form {
      margin-top: 0.8rem;
      padding: 0.8rem;
      background: #f8fafc;
      border-radius: 8px;
    }

    .reply-form textarea {
      width: 100%;
      padding: 0.6rem;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      font-size: 0.9rem;
      font-family: inherit;
      resize: vertical;
      min-height: 60px;
    }

    .reply-form textarea:focus {
      outline: none;
      border-color: #6366f1;
    }

    .reply-form-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .reply-submit-btn, .reply-cancel-btn {
      padding: 0.4rem 1rem;
      border: none;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .reply-submit-btn {
      background: #6366f1;
      color: white;
    }

    .reply-submit-btn:hover {
      background: #4f46e5;
    }

    .reply-cancel-btn {
      background: #e2e8f0;
      color: #4a5568;
    }

    .reply-cancel-btn:hover {
      background: #cbd5e1;
    }

    .view-more-btn {
      display: block;
      margin: 2rem auto 0;
      padding: 1rem 2.5rem;
      background: white;
      color: #6366f1;
      border: 2px solid #6366f1;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .view-more-btn:hover {
      background: #6366f1;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }

    .success-message {
      background: #d1fae5;
      color: #065f46;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      text-align: center;
      font-weight: 600;
    }

    .error-message {
      background: #fee2e2;
      color: #991b1b;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      text-align: center;
      font-weight: 600;
    }

    /* User Profile Styles */
    .user-profile {
      background: white;
      padding: 0.8rem 1.2rem;
      border-radius: 25px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      display: none;
      align-items: center;
      gap: 0.8rem;
      font-size: 0.9rem;
      margin-left: auto;
      margin-right: 1rem;
    }

    .user-profile.show {
      display: flex;
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6366f1, #4f46e5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 0.8rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      color: #2d3748;
    }

    .user-contact {
      font-size: 0.75rem;
      color: #718096;
    }

    .logout-btn {
      background: #ef4444;
      color: white;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 15px;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: #dc2626;
      transform: translateY(-1px);
    }

    @media (max-width: 768px) {
      .youtube-container {
        padding: 1rem;
      }

      .channel-header {
        padding: 2rem 1rem;
        margin-bottom: 2rem;
      }

      .channel-avatar {
        width: 120px;
        height: 120px;
      }

      .channel-name {
        font-size: 2rem;
      }

      .action-buttons {
        flex-direction: column;
        align-items: center;
      }

      .youtube-btn, .notes-btn {
        width: 100%;
        max-width: 300px;
      }

      .video-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .faq-section {
        padding: 1rem;
      }

      .faq-question {
        font-size: 1rem;
        padding: 1.2rem;
      }

      .comments-section {
        padding: 2rem 1rem;
      }

      .comment-form-container {
        padding: 1.5rem;
      }

      .comment-item {
        padding: 1.2rem;
      }

      .comment-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }

      .user-profile {
        position: fixed;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        margin: 0;
        width: calc(100% - 2rem);
        max-width: 300px;
        z-index: 1001;
      }
    }

  </style>
</head>
<body>
 
  <header>
    <div class="container nav-flex">
      <div class="logo-section">
        <a href="index.html" class="logo-link">
          <div class="logo">
            <img src="attached_assets/mainlogo_1753383095126.png" alt="SayHeyShubh">
          </div>
        </a>
      </div>
      
      <!-- User Profile Section -->
      <div class="user-profile" id="userProfile">
        <div class="user-avatar" id="userAvatar">U</div>
        <div class="user-info">
          <div class="user-name" id="userName">User</div>
          <div class="user-contact" id="userContact">***@***.com</div>
        </div>
        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>
      
      <div class="nav-toggle">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <nav>
        <ul>
          <li><a href="portfolio.html">Portfolio</a></li>
          <li><a href="blogs.html">Blogs</a></li>
          <li><a href="notes.html" class="active">Notes</a></li> 
          <li><a href="youtube.html">YouTube</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="youtube-container">
    <div class="channel-header">
      <img src="attached_assets/microbiology-avatar.jpg" alt="Best BSc Microbiology Hons Notes Delhi University - ShubhiPhilia Educational Content" class="channel-avatar" />
      <h1 class="channel-name">BSc Microbiology Hons Notes for DU Students üéì</h1>
       <h2>Semester-Wise PDF Notes, Previous Year Questions & Exam Preparation Resources</h2>
      
      <div class="action-buttons">
        <a href="https://www.youtube.com/@ShubhiPhilia" class="youtube-btn" target="_blank">
          üé• Visit My Channel
        </a>
        <button class="notes-btn" onclick="showAuthPopup()">
          üìö Download Notes
        </button>
      </div>

      <p class="channel-description">
       These <strong>BSc Microbiology notes</strong> are prepared by <strong>Aditi</strong>, a dedicated Microbiology student, and curated on <strong>SayHeyShubh</strong> to help Delhi University students study effectively without last-minute confusion.</p> 

      <p>The notes are <strong>syllabus-aligned, concise, and PYQ-focused</strong>, making them ideal for semester exams and quick revision.</p>

        <p><strong>Bas Mauj Masti Nahi Rukni Chahiye!!</strong>
      </p>   
    </div>

    <div class="stats-section">
      <h2 class="section-title">üìä BSc Microbiology Hons Study Resources & Content</h2>
      <div class="stats-grid">
        <div class="stat-item" onclick="handleRestrictedAccess()">
          <span class="stat-number">‚úçÔ∏è</span>
          <div class="stat-label">Handwritten Notes</div>
        </div>

        <div class="stat-item" onclick="window.open('https://t.me/shubhiphilia', '_blank')">
          <span class="stat-number">üìñ</span>
          <div class="stat-label">Important Books</div>
        </div>

        <div class="stat-item" onclick="handleRestrictedAccess()">
          <span class="stat-number">üéØ</span>
          <div class="stat-label">Previous Year Questions</div>
        </div>

        <div class="stat-item" onclick="window.open('https://www.youtube.com/@ShubhiPhilia', '_blank')">
          <span class="stat-number">üåü</span>
          <div class="stat-label">Academic Tips</div>
        </div>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="content-section faq-section">
      <h2 class="section-title">‚ùì Frequently Asked Questions - BSc Microbiology Hons Notes & Study Material</h2>
      <div class="faq-container">

        <div class="faq-item">
          <button class="faq-question" onclick="toggleFAQ(this)">
            <span>Who prepared these Microbiology notes?</span>
            <span class="faq-icon">+</span>
          </button>
          <div class="faq-answer">
            <p>The notes are prepared by <strong>Aditi</strong>, a Microbiology student, and reviewed for syllabus accuracy before publishing on SayHeyShubh.</p>
          </div>
        </div>

        <div class="faq-item">
          <button class="faq-question" onclick="toggleFAQ(this)">
            <span>Are these notes enough for DU semester exams?</span>
            <span class="faq-icon">+</span>
          </button>
          <div class="faq-answer">
            <p>Yes. The notes are designed using DU syllabus and PYQs, making them sufficient for scoring well in exams.</p>
          </div>
        </div>

        <div class="faq-item">
          <button class="faq-question" onclick="toggleFAQ(this)">
            <span>Do I need to pay to access the notes?</span>
            <span class="faq-icon">+</span>
          </button>
          <div class="faq-answer">
            <p>You just need to log in. Some notes may be free and some may require a small contribution to support the platform.</p>
          </div>
        </div>
        
      </div>
    </div>

    <div class="content-section">
      <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, #6366f1, #4f46e5); border-radius: 15px; color: white;">
        <h3 style="color: white; margin-bottom: 1rem;">Ready to Learn? üöÄ</h3>
        <p style="margin-bottom: 2rem; opacity: 0.9;">Join me on this amazing journey of learning and growth!</p>
        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
          <a href="https://www.youtube.com/@ShubhiPhilia" class="youtube-btn" target="_blank">
            Subscribe Now
          </a>
          <button class="notes-btn" onclick="showAuthPopup()">
            Get Study Notes
          </button>
        </div>
      </div>
    </div>

    <!-- Comments/Feedback Section -->
    <div class="content-section comments-section" id="comments-section">
      <h2 class="section-title">üí¨ Student Reviews & Feedback for BSc Microbiology Hons Study Materials</h2>
      <p style="text-align: center; color: #718096; margin-bottom: 2rem;">
        These reviews are shared by Delhi University students who used the notes, PYQs and study material from this page. Share your experience too and help other Delhi University students in their exam preparation journey!
      </p>
      
      <!-- Comment Form -->
      <div class="comment-form-container" id="commentFormContainer">
        <!-- Will be populated dynamically based on auth state -->
      </div>

      <!-- Comments Display -->
      <div class="comments-display" id="commentsDisplay">
        <h3 class="comments-title" id="commentsTitle">Loading comments...</h3>
        <div class="comments-list" id="commentsList">
          <!-- Comments will be loaded here -->
        </div>
        <button class="view-more-btn" id="viewMoreBtn" style="display: none;">
          View More Comments
        </button>
      </div>
    </div>
  </div>

  <!-- Authentication Modal -->
  <div id="authModal" class="auth-modal">
    <div class="auth-container">
      <button class="close-auth" onclick="hideAuthPopup()">&times;</button>
      
      <div class="auth-header">
        <h2>Access Study Notes</h2>
        <p>Sign up or log in to access exclusive BSc Microbiology notes</p>
      </div>

      <div class="auth-buttons">
        <button class="auth-btn google-btn" onclick="signInWithGoogle()">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          Continue with Google
        </button>

      </div>



      <div class="loading" id="loadingIndicator">
        <p>Processing...</p>
      </div>

    </div>
  </div>

  <footer>
    <div class="container">
      <p>¬© 2025 SayHeyShubh ‚Ä¢ Educational Content & Life Stories</p>
       <p> <a href="privacy-policy.html">Privacy Policy</a></p>
    </div>
  </footer>

  <script src="script.js"></script>
  <script src="firebase-config.js"></script>
  <script>
    const links = document.querySelectorAll('nav a');
    const currentPage = location.pathname.split("/").pop() || 'index.html';

    links.forEach(link => {
      const href = link.getAttribute("href");
      if (href === currentPage || (currentPage === 'index.html' && href === '/')) {
        link.classList.add("active");
      }
    });
  </script>
  <script>
    function waitForNavAndHighlight() {
      const navLinks = document.querySelectorAll("nav a");
      if (navLinks.length === 0) {
        // Retry until nav is loaded
        setTimeout(waitForNavAndHighlight, 50);
        return;
      }

      const path = window.location.pathname;
      let currentPage = path.split("/").pop() || "index";
      currentPage = currentPage.replace(".html", "");

      navLinks.forEach(link => {
        let href = link.getAttribute("href").replace(".html", "").replace("/", "");
        if (href === currentPage) {
          link.classList.add("active");
        }
      });
    }

    document.addEventListener("DOMContentLoaded", waitForNavAndHighlight);
  </script>

  <a href="https://t.me/shubhiphilia" class="doubts-btn" id="doubts-btn">
    üí¨
  </a>

  <div class="doubts-bubble" id="doubts-bubble">
    Got a question?
  </div>

  <script>
  // FAQ Toggle Function
  function toggleFAQ(button) {
    const answer = button.nextElementSibling;
    const isActive = button.classList.contains('active');
    
    // Close all FAQs
    document.querySelectorAll('.faq-question').forEach(q => {
      q.classList.remove('active');
      q.nextElementSibling.classList.remove('active');
    });
    
    // Open clicked FAQ if it wasn't active
    if (!isActive) {
      button.classList.add('active');
      answer.classList.add('active');
    }
  }

  // Comments System with Authentication
  let currentOffset = 0;
  const commentsPerPage = 10;
  let totalComments = 0;
  let allLoadedComments = [];
  let currentUserAuth = null;
  let activeReplyForm = null;

  // Detect API endpoints based on environment
  function getApiEndpoints() {
    const isLocal = window.location.hostname === 'localhost' || window.location.hostname.includes('repl');
    if (isLocal) {
      return {
        postComment: '/api/comments',
        getComments: '/api/comments/youtube'
      };
    } else {
      return {
        postComment: '/.netlify/functions/post-comment',
        getComments: '/.netlify/functions/get-comments'
      };
    }
  }

  // Mask email function
  function maskEmail(email) {
    if (!email || !email.includes('@')) return '***@***.com';
    const [user, domain] = email.split('@');
    if (user.length <= 2) return email;
    return user.slice(0, 2) + '***@' + domain;
  }

  // Initialize comments system
  document.addEventListener("DOMContentLoaded", function() {
    const bubble = document.getElementById("doubts-bubble");

    // Show bubble 0.8s after button appears
    setTimeout(() => {
      bubble.classList.add("show");
    }, 800);

    // Hide bubble after 3 seconds
    setTimeout(() => {
      bubble.classList.remove("show");
    }, 3800);

    // Setup view more button
    const viewMoreBtn = document.getElementById('viewMoreBtn');
    if (viewMoreBtn) {
      viewMoreBtn.addEventListener('click', loadMoreComments);
    }

    // Check auth state and setup comment form
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        currentUserAuth = user;
        await renderCommentForm(true);
      } else {
        currentUserAuth = null;
        await renderCommentForm(false);
      }

      // Load comments after auth check
      loadComments();
    });
  });

  // Render comment form based on auth state
  async function renderCommentForm(isAuthenticated) {
    const container = document.getElementById('commentFormContainer');

    if (isAuthenticated) {
      container.innerHTML = `
        <h3 class="comment-form-title">Share Your Experience</h3>
        <form id="commentForm" class="comment-form">
          <div class="form-group">
            <label for="commentText">How did these notes help you in Microbiology exams? *</label>
            <textarea 
              id="commentText" 
              name="comment" 
              placeholder="Share your experience with our study materials..." 
              required
              minlength="3"
              maxlength="1000"
            ></textarea>
            <span class="char-count" id="charCount">0/1000</span>
          </div>
          <button type="submit" class="submit-comment-btn" id="submitCommentBtn">
            Post Comment
          </button>
        </form>
      `;

      // Setup character counter
      const commentTextarea = document.getElementById('commentText');
      const charCount = document.getElementById('charCount');

      if (commentTextarea && charCount) {
        commentTextarea.addEventListener('input', function() {
          const count = this.value.length;
          charCount.textContent = `${count}/1000`;
          charCount.style.color = count > 900 ? '#dc2626' : '#94a3b8';
        });
      }

      // Setup form submission
      const commentForm = document.getElementById('commentForm');
      if (commentForm) {
        commentForm.addEventListener('submit', handleCommentSubmit);
      }
    } else {
      container.innerHTML = `
        <div class="auth-required-message">
          <p style="margin: 0 0 0.5rem 0; font-weight: 600; color: #92400e;">üîí Please log in to share your feedback</p>
          <p style="margin: 0 0 0.8rem 0; color: #78350f; font-size: 0.9rem;">Join our community and help other students!</p>
          <button onclick="showAuthPopup()">Log In to Comment</button>
        </div>
      `;
    }
  }

  // Handle comment submission
  async function handleCommentSubmit(e) {
    e.preventDefault();

    if (!currentUserAuth) {
      showAuthPopup();
      return;
    }

    const submitBtn = document.getElementById('submitCommentBtn');
    const commentInput = document.getElementById('commentText');
    const formContainer = document.getElementById('commentFormContainer');

    // Remove any existing messages
    const existingMsg = formContainer.querySelector('.success-message, .error-message');
    if (existingMsg) existingMsg.remove();

    submitBtn.disabled = true;
    submitBtn.textContent = 'Posting...';

    try {
      const idToken = await currentUserAuth.getIdToken();
      const endpoints = getApiEndpoints();

      const response = await fetch(endpoints.postComment, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${idToken}`
        },
        body: JSON.stringify({
          comment: commentInput.value,
          page: 'microbiology', // FIXED: changed from 'youtube' to 'microbiology'
        })
      });

      const data = await response.json();

      if (data.success) {
        // Show success message
        const successMsg = document.createElement('div');
        successMsg.className = 'success-message';
        successMsg.textContent = '‚úÖ Thank you! Your feedback has been posted successfully.';
        formContainer.insertBefore(successMsg, formContainer.firstChild);

        // Reset form
        commentInput.value = '';
        document.getElementById('charCount').textContent = '0/1000';

        // Reload comments
        currentOffset = 0;
        allLoadedComments = [];
        await loadComments();

        // Scroll to comments
        document.getElementById('commentsList').scrollIntoView({ behavior: 'smooth', block: 'nearest' });

        setTimeout(() => successMsg.remove(), 5000);
      } else {
        throw new Error(data.error || 'Failed to post comment');
      }
    } catch (error) {
      console.error('Error submitting comment:', error);
      const errorMsg = document.createElement('div');
      errorMsg.className = 'error-message';
      errorMsg.textContent = error.message.includes('authentication') ? 
        'Please log in to post a comment.' : 'Failed to post comment. Please try again.';
      formContainer.insertBefore(errorMsg, formContainer.firstChild);
      setTimeout(() => errorMsg.remove(), 5000);
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Post Comment';
    }
  }

  // Handle reply submission
  async function handleReplySubmit(parentId, replyText) {
    if (!currentUserAuth) {
      showAuthPopup();
      return;
    }

    try {
      const idToken = await currentUserAuth.getIdToken();
      const endpoints = getApiEndpoints();

      const response = await fetch(endpoints.postComment, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${idToken}`
        },
        body: JSON.stringify({
          comment: replyText,
          page: 'microbiology', // FIXED: changed from 'youtube' to 'microbiology'
          parentId: parentId
        })
      });

      const data = await response.json();

      if (data.success) {
        // Reload comments to show the new reply
        currentOffset = 0;
        allLoadedComments = [];
        await loadComments();
      } else {
        alert(data.error || 'Failed to post reply');
      }
    } catch (error) {
      console.error('Error posting reply:', error);
      alert('Failed to post reply. Please try again.');
    }
  }

  // Show reply form
  function showReplyForm(commentId) {
    if (!currentUserAuth) {
      showAuthPopup();
      return;
    }

    // Remove any existing reply form
    if (activeReplyForm) {
      activeReplyForm.remove();
      activeReplyForm = null;
    }

    const commentElement = document.querySelector(`[data-comment-id="${commentId}"]`);
    if (!commentElement) return;

    const replyForm = document.createElement('div');
    replyForm.className = 'reply-form';
    replyForm.innerHTML = `
      <textarea placeholder="Write your reply..." maxlength="1000"></textarea>
      <div class="reply-form-actions">
        <button class="reply-submit-btn">Reply</button>
        <button class="reply-cancel-btn">Cancel</button>
      </div>
    `;

    commentElement.appendChild(replyForm);
    activeReplyForm = replyForm;

    const textarea = replyForm.querySelector('textarea');
    const submitBtn = replyForm.querySelector('.reply-submit-btn');
    const cancelBtn = replyForm.querySelector('.reply-cancel-btn');

    submitBtn.addEventListener('click', async () => {
      const replyText = textarea.value.trim();
      if (replyText.length < 3) {
        alert('Reply must be at least 3 characters');
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'Posting...';

      await handleReplySubmit(commentId, replyText);

      if (activeReplyForm) {
        activeReplyForm.remove();
        activeReplyForm = null;
      }
    });

    cancelBtn.addEventListener('click', () => {
      replyForm.remove();
      activeReplyForm = null;
    });

    textarea.focus();
  }

    // Modified loadComments to respect Server-Side Rendered content
    async function loadComments() {
      const commentsList = document.getElementById('commentsList');

      // 1. HYDRATION CHECK:
      // If we have 0 loaded comments in memory, but the HTML list is NOT empty,
      // it means the Server (ODB) already did the job!
      if (allLoadedComments.length === 0 && commentsList.children.length > 0 && !commentsList.innerText.includes('Unable to load')) {
        console.log('Server-side comments detected. Skipping initial fetch.');

        // Update our internal counters based on what's already on the screen
        const serverItems = commentsList.querySelectorAll('.comment-item');
        currentOffset = serverItems.length;

        // Try to grab the total count from the title text (e.g., "13 Student Reviews")
        const titleText = document.getElementById('commentsTitle').textContent;
        const match = titleText.match(/(\d+)/);
        if (match) totalComments = parseInt(match[1]);

        updateViewMoreButton();
        return; // STOP! Don't fetch again. Keep the real comments.
      }

      // 2. STANDARD FETCH (Only runs if list is empty or user clicked "Load More")
      try {
        const endpoints = getApiEndpoints();
        // FIXED: Changed page=youtube to page=microbiology
        const response = await fetch(`${endpoints.getComments}?page=microbiology&limit=${commentsPerPage}&offset=${currentOffset}`);
        const data = await response.json();

        if (data.success) {
          totalComments = data.total;

          // If it's a "Load More" action, append. Otherwise, replace.
          if (currentOffset > 0) {
             allLoadedComments = [...allLoadedComments, ...data.comments];
          } else {
             allLoadedComments = data.comments;
          }

          currentOffset = allLoadedComments.length;

          displayComments(); // Renders the list from scratch using JS data
          updateViewMoreButton();
          updateCommentsTitle();
        }
      } catch (error) {
        console.error('Error loading comments:', error);

        // 3. SAFETY CHECK:
        // Only show the error message if the list is COMPLETELY EMPTY.
        // If we have old comments on screen, it's better to show them than an error.
        if (commentsList.children.length === 0) {
          document.getElementById('commentsTitle').textContent = 'Comments';
          commentsList.innerHTML = '<p style="text-align: center; color: #94a3b8;">Unable to load comments. Please try again later.</p>';
        }
      }
    }

  // Load more comments
  async function loadMoreComments() {
    const viewMoreBtn = document.getElementById('viewMoreBtn');
    viewMoreBtn.disabled = true;
    viewMoreBtn.textContent = 'Loading...';

    try {
      const endpoints = getApiEndpoints();
      // FIXED: Changed page=youtube to page=microbiology
      const response = await fetch(`${endpoints.getComments}?page=microbiology&limit=${commentsPerPage}&offset=${currentOffset}`);
      const data = await response.json();

      if (data.success && data.comments.length > 0) {
        allLoadedComments = [...allLoadedComments, ...data.comments];
        currentOffset += data.comments.length;

        displayComments();
        updateViewMoreButton();
      }
    } catch (error) {
      console.error('Error loading more comments:', error);
    } finally {
      viewMoreBtn.disabled = false;
      viewMoreBtn.textContent = 'View More Comments';
    }
  }

  // Display comments with replies
    function displayComments() {
      const commentsList = document.getElementById('commentsList');

      if (allLoadedComments.length === 0) {
        commentsList.innerHTML = '<p style="text-align: center; color: #94a3b8; padding: 1.5rem;">No comments yet. Be the first to share your feedback!</p>';
        return;
      }

      commentsList.innerHTML = allLoadedComments.map(comment => {
        const date = new Date(comment.created_at);
        const formattedDate = date.toLocaleDateString('en-US', {
          year: 'numeric', month: 'short', day: 'numeric',
          hour: '2-digit', minute: '2-digit'
        });

        const repliesCount = comment.replies ? comment.replies.length : 0;

        const viewRepliesBtn = repliesCount > 0 ? `
          <button class="view-replies-btn" data-comment-id="${comment.id}" onclick="toggleReplies(event, '${comment.id}')">
            <span class="replies-text">View ${repliesCount} ${repliesCount === 1 ? 'Reply' : 'Replies'}</span>
            <span class="arrow">‚ñº</span>
          </button>
        ` : '';

        const repliesHTML = (comment.replies && comment.replies.length > 0) ? `
          <div class="replies-container" id="replies-${comment.id}">
            ${comment.replies.map(reply => {
              const replyDate = new Date(reply.created_at);
              const formattedReplyDate = replyDate.toLocaleDateString('en-US', {
                year: 'numeric', month: 'short', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
              });

              return `
                <div class="reply-item" itemscope itemtype="https://schema.org/CreativeWork">
                  <div itemscope itemtype="https://schema.org/Comment" itemprop="comment">
                    <div class="comment-header">
                      <div class="comment-author-info">
                        <span class="comment-author" itemprop="author" itemscope itemtype="https://schema.org/Person">
                          <span itemprop="name">${escapeHtml(reply.name)}</span>
                        </span>
                        <span class="comment-email">${maskEmail(reply.email)}</span>
                      </div>
                      <time class="comment-date" datetime="${reply.created_at}" itemprop="datePublished">${formattedReplyDate}</time>
                    </div>
                    <div class="comment-text" itemprop="text">${escapeHtml(reply.comment)}</div>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        ` : '';


        return `
          <div class="comment-item" data-comment-id="${comment.id}" itemscope itemtype="https://schema.org/CreativeWork">
            <div itemscope itemtype="https://schema.org/Comment" itemprop="comment">
              <div class="comment-header">
                <div class="comment-author-info">
                  <span class="comment-author" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <span itemprop="name">${escapeHtml(comment.name)}</span>
                  </span>
                  <span class="comment-email">${maskEmail(comment.email)}</span>
                </div>
                <time class="comment-date" datetime="${comment.created_at}" itemprop="datePublished">${formattedDate}</time>
              </div>

              <div class="comment-text" itemprop="text">${escapeHtml(comment.comment)}</div>

              <div class="comment-actions">
                <button class="reply-btn" onclick="showReplyForm('${comment.id}')">üí¨ Reply</button>
                ${viewRepliesBtn}
              </div>

              ${repliesHTML}
            </div>
          </div>
        `;
      }).join('');
    }


  // Update view more button
  function updateViewMoreButton() {
    const viewMoreBtn = document.getElementById('viewMoreBtn');
    if (currentOffset < totalComments) {
      viewMoreBtn.style.display = 'block';
      viewMoreBtn.textContent = `View More (${totalComments - currentOffset} remaining)`;
    } else {
      viewMoreBtn.style.display = 'none';
    }
  }

  // Update comments title
  function updateCommentsTitle() {
    const commentsTitle = document.getElementById('commentsTitle');
    if (totalComments === 0) {
      commentsTitle.textContent = 'Student Feedback & Reviews';
    } else if (totalComments === 1) {
      commentsTitle.textContent = '1 Student Review';
    } else {
      commentsTitle.textContent = `${totalComments} Student Reviews`;
    }
  }

  // HTML escape function
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // Toggle replies visibility
    // Toggle replies visibility ‚Äî updated to work with new markup
    function toggleReplies(event, commentId) {
      event.stopPropagation(); // avoid bubbling glitches

      const repliesContainer = document.getElementById(`replies-${commentId}`);
      const button = event.currentTarget;

      if (!repliesContainer || !button) return;

      // Toggle visibility classes
      repliesContainer.classList.toggle('show');
      button.classList.toggle('active');

      const repliesText = button.querySelector('.replies-text');
      const repliesCount = repliesContainer.querySelectorAll('.reply-item').length;

      // Update button text
      if (repliesContainer.classList.contains('show')) {
        repliesText.textContent = `Hide ${repliesCount} ${repliesCount === 1 ? 'Reply' : 'Replies'}`;
      } else {
        repliesText.textContent = `View ${repliesCount} ${repliesCount === 1 ? 'Reply' : 'Replies'}`;
      }
    }

  </script>

  <!-- Cookie Consent Banner -->
  <div id="cookie-banner" class="cookie-banner">
    <p>
      üç™ This website uses cookies to enhance your experience.  
      <a href="/privacy-policy.html" target="_blank">Learn more</a>
    </p>
    <div class="cookie-buttons">
      <button id="accept-cookies" class="accept-btn">Accept</button>
      <span id="close-cookies" class="close-btn">&times;</span>
    </div>
  </div>

  <style>
    /* Cookie Banner Styling */
    .cookie-banner {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ffffff;
      color: #333;
      padding: 14px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
      font-size: 14px;
      max-width: 600px;
      width: 90%;
      z-index: 1000;
      transition: opacity 0.3s ease-in-out;
    }

    .cookie-banner a {
      color: #6366f1;
      text-decoration: none;
      font-weight: 500;
    }

    .cookie-buttons {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .accept-btn {
      background: #6366f1;
      color: white;
      padding: 6px 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      transition: background 0.3s ease;
    }

    .accept-btn:hover {
      background: #4f46e5;
    }

    .close-btn {
      font-size: 20px;
      cursor: pointer;
      color: #777;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: #333;
    }

    .cookie-banner.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    /* Auth Modal Styles */
    .auth-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }

    .auth-modal.show {
      display: flex;
    }

    .auth-container {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .auth-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .auth-header h2 {
      color: #2d3748;
      margin-bottom: 0.5rem;
    }

    .auth-header p {
      color: #718096;
      font-size: 0.9rem;
    }

    .auth-buttons {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .auth-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.8rem;
      padding: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      background: white;
      color: #2d3748;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .auth-btn:hover {
      border-color: #6366f1;
      background: #f8fafc;
      transform: translateY(-2px);
    }

    .google-btn {
      border-color: #4285f4;
      color: #4285f4;
    }

    .google-btn:hover {
      background: #4285f4;
      color: white;
    }



    .verification-input {
      width: 100%;
      padding: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1rem;
      margin-bottom: 1rem;
      text-align: center;
      letter-spacing: 0.2rem;
    }

    .close-auth {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #718096;
      z-index: 10001;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .close-auth:hover {
      background: rgba(113, 128, 150, 0.1);
      color: #2d3748;
    }

    .loading {
      display: none;
      text-align: center;
      color: #6366f1;
    }


  </style>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const banner = document.getElementById("cookie-banner");
      const acceptBtn = document.getElementById("accept-cookies");
      const closeBtn = document.getElementById("close-cookies");

      // Check if user already accepted or closed
      if (localStorage.getItem("cookieConsent")) {
        banner.classList.add("hidden");
      }

      // Accept cookies
      acceptBtn.addEventListener("click", () => {
        localStorage.setItem("cookieConsent", "accepted");
        banner.classList.add("hidden");
      });

      // Close banner (decline)
      closeBtn.addEventListener("click", () => {
        localStorage.setItem("cookieConsent", "declined");
        banner.classList.add("hidden");
      });
    });
  </script>

  <!-- Firebase Configuration and Authentication -->
  <script>
    // Firebase is initialized in firebase-config.js
    let currentUser = null;

    // Authentication functions
    function showAuthPopup() {
      document.getElementById('authModal').classList.add('show');
    }

    function hideAuthPopup() {
      document.getElementById('authModal').classList.remove('show');
      // Reset loading indicator if it exists
      const loadingEl = document.getElementById('loadingIndicator');
      if (loadingEl) loadingEl.style.display = 'none';
    }

    function showLoading(show = true) {
      document.getElementById('loadingIndicator').style.display = show ? 'block' : 'none';
    }

    // Google Sign-in
    async function signInWithGoogle() {
      showLoading();
      try {
        const provider = new firebase.auth.GoogleAuthProvider();
        const result = await auth.signInWithPopup(provider);
        const user = result.user;
        
        // Get device ID and register it
        const deviceId = getDeviceId();
        const userRef = db.collection('users').doc(user.uid);
        const userDoc = await userRef.get();
        
        if (!userDoc.exists) {
          // Save new user data with device registration
          await userRef.set({
            name: user.displayName,
            email: user.email,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            authMethod: 'google',
            devices: {
              [deviceId]: true
            }
          });
        } else {
          // Update existing user with new device
          await userRef.update({
            [`devices.${deviceId}`]: true
          });
        }
        
        currentUser = user;
        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('userId', user.uid);
        localStorage.setItem('userName', user.displayName);
        localStorage.setItem('userEmail', user.email);
        
        hideAuthPopup();
        showLoading(false);
        
        // Reload the page to show logged-in state
        window.location.reload();
        
      } catch (error) {
        showLoading(false);
        alert('Google sign-in failed: ' + error.message);
      }
    }





    // Check if user is already logged in and update UI accordingly
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        currentUser = user;
        
        // Check if device is still valid
        try {
          const deviceId = getDeviceId();
          const userRef = db.collection('users').doc(user.uid);
          const doc = await userRef.get();
          
          if (doc.exists) {
            const data = doc.data();
            const devices = data.devices || {};
            
            if (devices[deviceId]) {
              // User is authenticated - update buttons and UI
              console.log('User is authenticated - updating UI');
              updateUIForLoggedInUser(user, data);
              return;
            }
          }
        } catch (error) {
          console.error('Authentication check failed:', error);
          // Continue with normal flow if check fails
        }
      }
      
      // User is not authenticated - show normal login buttons
      console.log('User not authenticated - showing login options');
    });

    // Function to update UI for logged-in users
    function updateUIForLoggedInUser(user, userData) {
      // Change the "Download Notes" buttons to "Access Notes" since user is already logged in
      const notesButtons = document.querySelectorAll('.notes-btn');
      notesButtons.forEach(btn => {
        btn.textContent = 'üìö Access My Notes';
        // Point to the SPECIFIC Microbiology years page now
        btn.onclick = function() {
          window.location.href = 'Microbiology-years.html';
        };
      });
      
      // Add a welcome message right below the action buttons
      const actionButtons = document.querySelector('.action-buttons');
      if (actionButtons && userData && !document.querySelector('.welcome-message')) {
        const welcomeMsg = document.createElement('div');
        welcomeMsg.className = 'welcome-message';
        welcomeMsg.style.cssText = `
          background: linear-gradient(135deg, #22c55e, #16a34a);
          color: white;
          padding: 0.9rem 1.2rem;
          border-radius: 10px;
          margin-top: 1rem;
          text-align: center;
          font-weight: 600;
          font-size: 0.95rem;
          box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        `;
        welcomeMsg.innerHTML = `üëã Hello, ${userData.name || user.displayName || 'User'}! You're all set to access your notes.`;
        actionButtons.parentNode.insertBefore(welcomeMsg, actionButtons.nextSibling);
      }
      
      // Load user profile
      loadUserProfile();
    }

    // Load user profile from localStorage
    function loadUserProfile() {
      const userName = localStorage.getItem('userName');
      const userEmail = localStorage.getItem('userEmail');
      const userPhone = localStorage.getItem('userPhone');

      if (userName) {
        // Set user name
        document.getElementById('userName').textContent = userName;

        // Set user avatar (first letter of name)
        document.getElementById('userAvatar').textContent = userName.charAt(0).toUpperCase();

        // Set masked contact info
        let contactInfo = '';
        if (userEmail) {
          const emailParts = userEmail.split('@');
          const maskedEmail = emailParts[0].substring(0, 2) + '***@' + emailParts[1];
          contactInfo = maskedEmail;
        } else if (userPhone) {
          const maskedPhone = userPhone.substring(0, 3) + '***' + userPhone.substring(userPhone.length - 2);
          contactInfo = maskedPhone;
        }

        document.getElementById('userContact').textContent = contactInfo;

        // Show user profile
        document.getElementById('userProfile').classList.add('show');
      }
    }

    // Logout function
    async function logout() {
      try {
        await auth.signOut();
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userId');
        localStorage.removeItem('userName');
        localStorage.removeItem('userEmail');
        localStorage.removeItem('userPhone');

        // Reload the page to show logged-out state
        window.location.reload();
      } catch (error) {
        console.error('Logout error:', error);
        alert('Error logging out. Please try again.');
      }
    }

    // Check URL parameters and show login popup if needed
    document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('showLogin') === 'true') {
        // Show login popup automatically when redirected from protected page
        setTimeout(() => {
          showAuthPopup();
        }, 500); // Small delay to ensure page is fully loaded
        
        // Clean up URL by removing the parameter
        const url = new URL(window.location);
        url.searchParams.delete('showLogin');
        window.history.replaceState({}, document.title, url.pathname);
      }
      
      // Load user profile from localStorage on page load
      loadUserProfile();
    });

    // Close modal when clicking outside
    document.getElementById('authModal').addEventListener('click', (e) => {
      if (e.target.id === 'authModal') {
        hideAuthPopup();
      }
    });

    // Function to handle clicks on Stat Items (Notes/PYQs)
    function handleRestrictedAccess() {
      if (currentUser || localStorage.getItem('isLoggedIn') === 'true') {
        // User is logged in -> Go directly to notes page
        window.location.href = 'Microbiology-years.html';
      } else {
        // User is NOT logged in -> Show the popup
        showAuthPopup();
      }
    }
  </script>
</body>
</html>